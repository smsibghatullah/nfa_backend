{% extends "admin/base_site.html" %}

{% block content %}
<div class="max-w-6xl mx-auto mt-10 p-6 bg-white shadow-lg rounded-lg">

  <a href="{% url 'admin:candidates_candidate_changelist' %}" 
     class="inline-flex items-center mb-4 px-3 py-1.5 rounded-md font-semibold text-white"
     style="background-color: #147814; border-radius: 0.375rem;">
    ‚Üê Back to Candidates
  </a>

  <h1 class="text-2xl font-bold text-gray-800 mb-6">üîç Search Candidates</h1>

  <form method="get" class="flex flex-col sm:flex-row items-start sm:items-center mb-6 gap-3">
      <input 
          type="text" 
          name="q" 
          placeholder="Search by CNIC or Name" 
          value="{{ query }}"
          class="w-full sm:w-64 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
      />
      <button 
          type="submit" 
          class="px-4 py-2 font-semibold text-white rounded-md shadow"
          style="background-color: #147814; border-radius: 0.375rem;"
          onmouseover="this.style.backgroundColor='#0f6012';" 
          onmouseout="this.style.backgroundColor='#147814';"
      >
          Search
      </button>
  </form>

  {% if candidates %}
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Roll No</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Name</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">CNIC</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Mobile No</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Test Schedule</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          {% for c in candidates %}
          <tr class="hover:bg-gray-50">
            <td class="px-4 py-2">{{ c.roll_no }}</td>
            <td class="px-4 py-2">{{ c.name }}</td>
            <td class="px-4 py-2">{{ c.cnic }}</td>
            <td class="px-4 py-2">{{ c.mobile_no }}</td>
            <td class="px-4 py-2 space-y-2">
              {% for t in c.test_schedules.all %}
              <div class="p-3 bg-gray-50 border border-gray-200 rounded-md shadow-sm">
                  <p><span class="font-semibold">Post:</span> {{ t.job_post.title }}</p>
                  <p><span class="font-semibold">Paper:</span> {{ t.paper }}</p>
                  <p><span class="font-semibold">Date:</span> {{ t.test_date }}</p>
                  <p><span class="font-semibold">Session:</span> {{ t.session }}</p>
                  <p><span class="font-semibold">Reporting Time:</span> {{ t.reporting_time }}</p>
                  <p><span class="font-semibold">Conduct Time:</span> {{ t.conduct_time }}</p>
                  <p><span class="font-semibold">Venue:</span> {{ t.venue }}</p>
              </div>
              {% endfor %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% elif query %}
    <p class="text-gray-500 mt-4">No results found.</p>
  {% endif %}

</div>
{% endblock %}
